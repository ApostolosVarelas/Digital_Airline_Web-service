
# Digital Airlines

Αυτή η εργασία αφορά τις λειτουργίες ενός website μίας αεροπορικής εταιρείας. 

## Οδηγείες χρήσης
Για την σωστή χρήση του προγράμματος προτείνεται να τρέξει όλη η ερφασία μέσα απο τον φάκελο InfoSys. Επίσης, τα paths στο Dockerfile και στο docker-compose μπορεί να είναι διαφορετικά απο αυτά στο δικό σας σύστημα.

__Στοιχεία Admin__
```code
{
    _id: 'ADM',
    firtname: 'Apostolos',
    lastname: 'Varelas',
    email: 'aposvarelas@gmail.com',
    password: '1234',
    date_of_dirth: '24-09-2002',
    country_of_origin: 'Greece',
    passport_number: '1234',
    type: 'Admin'
}
```

## Υλοποίηση Containerization

Αρχικά, χρειάστηκα ένα Virtual Machine για να εξομοιώσω το λειτουργικό σύστημα Ubuntu, μέσα στο οποίο έφτιαξα το docker μέσα στο οποίο θα έτρεχε ο κώδικας για τις λειτουργίες της σελίδες. Για να φτιάξω το docker, έπρεπε να χρησιμοποιήσω μία πληθώρα εντολών, για να εγκαταστήσω αρχικά το docker στον υπολογιστή, να κατεβάσω το image για την Mongo και στην συνέχεια να φτιάξω το Dockerfile και το docker-compose, με λίγα λόγια να κάνουμε Containerization, έτσι ώστε  οι εφαρμογές να εκτελούνται σε απομονωμένο περιβάλλον χρήστη που ονομάζονται container.


## Κώδικας
Αφού το docker ήταν έτοιμο και λειτουργικό, ξεκίνησα την διαδικασία ανάπτυξης του κώδικα ο οποίος χωρίζεται σε 2 κομμάτια. Τις διαδικασίες που μπορεί να κάνει μόνο ο admin και τις διαδικασίες που μπορούν να κάνουν από κοινού. Συγκεκριμένα:

### Λειτουργίες User/Admin

- __Εγγραφή στο σύστημα__
  
Αυτή η λειτουργεία εκτελείται μέσω στην συνάρτησης def register(), η οποία εκτελείται όταν για URL δοθεί το __localhost:6000/register__ με μέθοδο POST, αφού επιχειρείται εγγραφή στην βάση δεδομένων. Στην συγκεκριμένη συνάρτηση, ο χρήστης πρέπει να εισάγει τα το όνομα του (το οποίο χρησιμοποιείται και ως username), το επώνυμο του, το email του, τον κωδικό που επιθυμεί να χρησιμοποιεί στο σύστημα, την ημερομηνία γέννησης του, την χώρα καταγωγής του καθώς και τον αριθμό διαβατηρίου του. Για να γίνει σωστή εισαγωγή στοιχείων, θα πρέπει να υπάρχει η παρακάτω εισαγωγή στοιχείων	

```json
{
  "firstname": "",
  "lastname": "",
  "email": "",
  "password": "",
  "date_of_birth": "",
  "country_of_origin": "",
  "passport_number": ""
}
```
Με την σωστή εισαγωγή των στοιχείων, ο χρήστης εγγράφεται επιτυχώς στο σύστημα. Διαφορετικά, εμφανίζεται μήνυμα λάθους. Επιπλέον, αν υπάρχει ήδη λογαριασμός με το ίδιο username και email, τότε εμφανίζει και πάλι μήνυμα λάθους. Με την επιτυχής σύνδεση του χρήστη, του δίνεται μαζί ένα μοναδικό _id το οποίο είναι URi, όπου i ένας αύξοντα αριθμός, και ένα type το οποίο απο default είναι πάντα 'User'.

- __Σύνδεση στο σύστημα__
  
Αυτή η λειτουργεία εκτελείται μέσω στην συνάρτησης def login(), η οποία εκτελείται όταν για URL δοθεί το __localhost:6000/login__ με μέθοδο POST. Όταν ο χρήστης επιθυμεί να κάνει σύνδεση στο σύστημα θα πρέπει να κάνει request στο στην παραπάνω δίευθυνση, δίνοντας σωστά στοιχεία email και password. Η σωστή μορφή είναι η παρακάτω:
```json
{
  "email": "",
  "password": ""
}
```
Με την σωστή σύνδεση του χρήστη, δημιουργείται ένα session στο οποίο αποθηκεύεται το _id του χρήστη, ώστε να μπορεί να έχει πρόσβαση στις λειτουργείες του, και το type του χρήστη, ώστε ένας απλός χρήστης να μην μπορεί να εκτελέσει τις λειτουργείες του admin. Αυτό ελέγχεται απο την μεταβλητή session, την type, η οποία δείχνει τον τύπο του χρήστη (User ή Admin). Μόνο με την επιτυχής σύνδεση του χρήστη μπορούν να υλοποιηθούν οι παρακάτω λειτουργείες, διαφορετικά το σύστημα προτρέπει τον χρήστη να κάνει σύνδεση. Αυτό ελέγχεται απο την μεταβλητή session, την _id, η οποία αν δεν είναι άδεια, τότε σημαίνει ότι ο χρήστης έχει κάνει επιτυχής σύνδεση.

- __Έξοδος απο το σύστημα__
  
Όταν ο χρήστης επιθυμεί να κάνει έξοδο απο το σύστημα, το μόνο που έχει να κάνει είναι να παέι στο URL __localhost:6000/logout__ με μέθοδο POST. Μόλις ο χρήστης πατήσει αυτή την διεύθυνση, τότε αυτομάτως αποσυνδέεται απο το σύστημα. Αυτό γίνεται, διαγράφοντας τις τιμές του session στα πεδία _id και _type.

- __Αναζήτηση πτύσεων__
  
Όταν ο χρήστης επιθυμεί να κάνει αναζήτηση πτύσεων, θα πρέπεοι να παέι στο URL __localhost:6000/flight_search__ με μέθοδο GET, αφού το μόνο που χρειάζεται είναι να διαβάσει αρχεία απο την βάση δεδομένων. Εκεί, ο χρήστης έχει την επιλογή να ψάξει για πτύσεις με 4 διαφορετικούς τρόπους.
1. Βάση αεροδρόμιο προέλευσης και αεροδρόμιο τελικού προορισμού.
Σε αυτή την περίπτωση ο χρήστης θα πρέπει να κάνει το παρακάτω request:
```json
{
  "choice": 0,
  "origin": "",
  "destination": ""
}
```
Όπου "orinin" είναι το αεροδρόμιο προέλευσης και "destination" το αεροδρόμιο προορισμού.

2. Βάση αεροδρόμιο προέλευσης, αεροδρόμιο τελικού προορισμού και ημερομηνία
διεξαγωγής.
Σε αυτή την περίπτωση ο χρήστης θα πρέπει να κάνει το παρακάτω request:
```json
{
  "choice": 1,
  "origin": "",
  "destination": ""
  "date": ""
}
```
Όπου "orinin" είναι το αεροδρόμιο προέλευσης, "destination" το αεροδρόμιο προορισμού και "date" η ημερομηνία διεξαγωγής.

3. Βάση ημερομηνίας
Σε αυτή την περίπτωση ο χρήστης θα πρέπει να κάνει το παρακάτω request:
```json
{
  "choice": 2,
  "date": ""
}
```
Όπου "date" είνια η ημερομηνία διεξαγωγής.

4. Εμφάνιση όλων των διαθέσιμων πτήσεων.

Σε αυτή την περίπτωση ο χρήστης θα πρέπει να κάνει το παρακάτω request:
```json
{
  "choice": 3,
}
```
Όπου απλά εμφανίζονται όλες οι πτύσεις.

Σε Όλες τις παραπάνω περιπτώσεις ο χρήστης θα λαμβάνει πληροφορίες για τους μοναδικούς κωδικούς των πτύσεων, την ημερομηνία διεξαγωγής, το αεροδρόμιο προέλευσης και το αεροδρόμιο προορισμού, για τις διαθέσιμες πτήσεις σχετικά με τα φίλτα που έβαλαν.

Στην περίπτωση που δεν υπάρχουν διαθέσιμες πτήσεις, το σύστημα εμφανίζει στο χρήστη αυτή την πληροφορία.Σε περίπτωση λανθασμένης εισαγωγής στοιχείων, το σύστημα επιστρέφει μήνυμα λάθους.

Με την ορθή εισαγωγή στοιχείων, το σύστημα αρχικά ψάχνει νμα βρει όλες τις πτήσεις που ικανοποιούν τις προδιαγραφές του χρήστη, τις αποθηκεύει σε μία μεταβλητή flight, και σην συνέχεια εμφανίζει τα στοιχεία που αναφέρθηκαν πριν λίγο.

- __Εμφάνιση στοιχείων πτήσης__
  
Όταν ο χρήστης επιθυμεί να εμφανίσει τα στοιχεία μιας πτύσης, θα πρέπει να παέι στο URL __localhost:6000/one_flight_search__ με μέθοδο GET, αφού το μόνο που χρειάζεται είναι να διαβάσει αρχεία απο την βάση δεδομένων. Ο χρήστης θα χρειαστεί να δώσει στο σύστημα απλά τον μοναδικό κωδικό της πτύσης για να λάβει πληροφορίες για την ημερομηνία διεξαγωγής της, το αεροδρόμιο προέλευσης και το αεροδρόμιο τελικού προορισμού, τα διαθέσιμα εισιτήρια (economy και business), καθώς και το κόστος των εισιτηρίων για τη κάθε μία από τις δύο κατηγορίες (economy και business). Η σωστή μορφή του request είναι η εξής:
```json
{
  "_id": "",
}
```
Σε περίπτωση λανθασμένης μορφής request το σύστημα επιστρέφει μήνυμα λάθους. Επίσης, αν η πτύση που αναζητάει ο χρήστης δεν υπάρχει, ενημερώνει τον χρήστη.

- __Κράτηση εισιτηρίου__

Όταν ο χρήστης επιθυμεί να κάνει κράτηση εισιτηρίου, θα πρέπει να παέι στο URL __localhost:6000/reservation__ με μέθοδο POST, αφού χρειάζεται να εισάγει αρχεία στην βάση δεδομένων.  Ο χρήστης θα χρειαστεί να δώσει στο σύστημα το _id της πτύσης, το όνομα και το επώνυμο, τον αριθμό του διαβατηρίου, την ημερομηνία γέννησης και το email του ατόμου στο οποίο επιθυμεί να γίνει η κράτηση, καθώς και τον τύπο εισιτηρίου (business ή economy). Η σωστή δομή του request είναι η εξής:
```json
{
  "flight_id": "",
  "firstname": "",
  "lastname": "",
  "passport_number": "",
  "date_of_birth": "",
  "email": "apovarelas@gmail.com",
  "ticket_type": ""
}
```
Σε περίπτωση λανθασμένης μορφής request το σύστημα επιστρέφει μήνυμα λάθους. Επιπλέον, σε περίπτωση που δεν υπάρχει	η πτύση ή ο τύπος εισιτηρίου ή τα εισιτήρια αυτού του τύπου για αυτή την πτύση είναι πλήρης, ενημερώνει τον χρήστη.
Το σύστημα δέχεται τα δεδομένων απο τον χρήστη και αρχικά ελέγχει αν ο τύπος εισιτηρίου είναι σωστός. Στην συνέχεια, αφού ελέγξει ότι η πτήση υπάρχει, θα ελέγξει αν υπάρχουν διαθέσιμα εισιτήρια για αυτή την πτύση. Αν ναι, τότε θα εισάγει την κράτηση στο collection reservations και θα ενημερώσει στα στοιχεία της πτύσης, μειώνοντας τα διαθέσιμα εισιτήρια αυτού του τύπου για αυτή την πτύση. 

- __Εμφάνιση κρατήσεων__

Όταν ο χρήστης επιθυμεί να εμφανίσει τα στοιχεία των κρατήσεων του, θα πρέπει να παέι στο URL __localhost:6000/show_reservation__ με μέθοδο GET, αφού το μόνο που χρειάζεται είναι να διαβάσει αρχεία απο την βάση δεδομένων. Εκέι, δεν χρειάζεται να εισάγει δεδομένων, αφου αποθηκεύονται βάση τον μοναδικό κωδικό του χρήστη. Εκεί, θα του εμφανιστούν όλες οι κρατήσεις που έχει κάνει, δείχνοντας τον κωδικό της κράτησης, τον κωδικό της πτύσης και τον τύπο του εισιτηρίου.

Το σύστημα ψάχνει με βάση το _id του χρήστη (που το παίρνει απο το session) στο collection reservations αν υπάρχει κράτηση στην οποία η τιμή της μεταβλητή "user" είναι ίδια με τον κωδικό του χρήστη. Αφού βρει ποιές κρατήσεις έχει κάνει αποθηκεύει τα δεδομένα και στην συνέχεια τα εμφανίζει.

- __Εμφάνιση στοιχείων κράτησης__
   
Όταν ο χρήστης επιθυμεί να εμφανίσει τα στοιχεία μιας κράτησης του, θα πρέπει να παέι στο URL __localhost:6000/reservation_details__ με μέθοδο GET, αφού το μόνο που χρειάζεται είναι να διαβάσει αρχεία απο την βάση δεδομένων. Εκεί, θα πρέπει να εισάγει τον κωδικό της κράτησης που επιθυμεί να δεί τα στοιχεία της με τον εξής τρόπο:
```json
{
  "_id": ""
}
```

Όπου _id ο κωδικός της κράτησης. Το σύστημα θα εμφανίζει στον χρήστη αεροδρόμιο προέλευσης, αεροδρόμιο τελικού προορισμού, ημερομηνία διεξαγωγής της πτήσης, όνομα και επώνυμο ατόμου για το οποίο έχει γίνει η κράτηση, αριθμό διαβατηρίου ατόμου για το οποίο έχει γίνει η κράτηση, ημερομηνία γέννησης ατόμου για το οποίο έχει γίνει η κράτηση, email ατόμου για το οποίο έχει γίνει η κράτηση και αν το εισιτήριο αφορά business ή economy class.

Το σύστημα δέχεται τον κωδικό που έδωσε ο χρήστης και ελέγχει αν υπάρχει κράτηση με αυτόν τον κωδικό, αν όχι επιστρέφει μήνυμα για να πληροφορήσει τον χρήστη. Επίσης τσεκάρει αν η μορφή του request είναι σωστή. Στην συνέχεια, ψάχνει να βρεί την κράτηση με αυτά τα στοιχεία και αποθηκεύει τα δεδομένα που χρειάζεται σε μια μεταβλητή, ώστε στο τέλος να τα εμφανίσει.

- __Ακύρωση κράτησης__
Όταν ο χρήστης επιθυμεί να κάνει ακύρωση κράτηση, θα πρέπει να παέι στο URL __localhost:6000/cancel_reservation__ με μέθοδο POST, αφού χρειάζεται να αλλάξουμε αρχεία στην βάση δεδομένων. Εκεί ο χρήστης θα χρειασεί να εισάγει τον κωδικό της κράτησης την οποία θέλει να ακυρώσει, όμως μπορεί να ακυρώσει μόνο κρατήσεις οι οποίες έχουν γίνει απο αυτόν. Η σωστή μορφή του request είναι η εξής:
```json
{
  "_id": ""
}
```
Το σύστημα, αρχικά θα ελένξει αν η μορφή του request είναι σωστή, αλλιώς θα εμφανίσει μήνυμα λάθους. Στην συνέχεια θα λάβει το _id της κράτησης και θα ψάξει να δει αν υπάρχει κράτηση που έχει κάνει αυτός ο χρήστης με αυτό το _id. Αν ναι την διαγράφει, αλλίως εμφανίζει μήνυμα λάθους.

- __Διαγραφή λογαριασμού__
Όταν ο χρήστης επιθυμεί να κάνει διαγραφή του λογαριασμού του, θα πρέπει να παέι στο URL __localhost:6000/delete acc__ με μέθοδο DELETE, αφού θέλει να διαγράψει δεδομένα απο την βάση. Εκεί, απλα θα διαγραφτεί ο λογαριασμού του χωρίς να χρειάζεται να εισάγει κάποια στοιχεία. Το σύστημα αρχικά θα αποσυνδέσει τον χρήστη και στην συνέχεια, θα διαγράψει τον λογαριασμό του μαζί με τις κρατήσεις που έχει κάνει.


### Λειτουργίες Admin
